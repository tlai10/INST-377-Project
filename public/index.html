<!DOCTYPE html>

<head>
  <html lang="en">
  <title>Home - Speed Camera Mapping Service</title>
  <meta charset="UTF-8">
  <!-- Our group used a CSS template from W3 found here - https://www.w3schools.com/w3css/w3css_templates.asp -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js"></script>
  <script src="https://kit.fontawesome.com/888dc0db7b.js" crossorigin="anonymous"></script>
</head>

<body>
  <!-- Navbar -->
  <div class="w3-top">
    <div class="w3-bar w3-black w3-card">
      <a class="w3-bar-item w3-button w3-padding-large w3-hide-medium w3-hide-large w3-right" href="javascript:void(0)"
        onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
      <a href="index.html" class="w3-bar-item w3-button w3-padding-large">HOME</a>
      <a href="about.html" class="w3-bar-item w3-button w3-padding-large w3-hide-small">ABOUT</a>
      <a href="documentation.html" class="w3-bar-item w3-button w3-padding-large w3-hide-small">DOCUMENTATION</a>
      <a href="javascript:void(0)" class="w3-padding-large w3-hover-red w3-hide-small w3-right"><i
          class="fa fa-search"></i></a>
    </div>
  </div>

  <!-- Navbar on small screens (remove the onclick attribute if you want the navbar to always show on top of the content when clicking on the links) -->
  <div id="navDemo" class="w3-bar-block w3-black w3-hide w3-hide-large w3-hide-medium w3-top" style="margin-top:46px">
    <a href="#about" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">ABOUT</a>
    <a href="#documentation" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">DOCUMENTATION</a>
    <a href="#" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()"></a>
  </div>

  <!-- Page content -->
  <div class="w3-content" style="max-width:2000px;margin-top:46px">

    <!-- The about Section -->
    <div class="w3-container w3-content w3-center w3-padding-64" style="max-width:800px" id="about">

      <h2 class="w3-wide">Speed Camera Mapping Service</h2>

      <!-- Borrowed image from telegraph.co.uk -->
      <img
        src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fsecure.i.telegraph.co.uk%2Fmultimedia%2Farchive%2F01861%2FspeedCamera_1861957a.jpg&f=1&nofb=1"
        style="width:100%">

      <p class="w3-justify">Welcome to our system! This website is meant to provide Prince George's County residents
        with locations of speed cameras. Please scroll down to begin using our service.</p>
      <p class="w3-justify">The 'Home' page holds our main feature - the mapping and listing service. The 'About' page
        will tell users more about the speed trap issues. Lastly, the 'Documentation' page provides users with in-depth
        instructions and help.</p>

      <h3>Search by District:</h3>

      <div class="dropdown">
        <button class="dropbtn">Dropdown</button>
        <div class="dropdown-content">
          <a href="#">I</a>
          <a href="#">II</a>
          <a href="#">III</a>
          <a href="#">IV</a>
          <a href="#">V</a>
          <a href="#">VI</a>
        </div>
      </div>

      <!-- Clickable button -->
      <button class="button" onclick="loadLeaflet()">Select District</button>
      <br>
      <br>
      <br>
      <br>
      <br>
      <br>
      <div id="map"></div>
      
      <!-- Image of location/map 
<img src="/w3images/map.jpg" class="w3-image w3-greyscale-min" style="width:100%">
-->



      <script>
        // Automatic Slideshow - change image every 4 seconds
        var myIndex = 0;
        carousel();

        function carousel() {
          var i;
          var x = document.getElementsByClassName("mySlides");
          for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
          }
          myIndex++;
          if (myIndex > x.length) { myIndex = 1 }
          x[myIndex - 1].style.display = "block";
          setTimeout(carousel, 4000);
        }

        // Used to toggle the menu on small screens when clicking on the menu button
        function myFunction() {
          var x = document.getElementById("navDemo");
          if (x.className.indexOf("w3-show") == -1) {
            x.className += " w3-show";
          } else {
            x.className = x.className.replace(" w3-show", "");
          }
        }

        // When the user clicks anywhere outside of the modal, close it
        var modal = document.getElementById('ticketModal');
        window.onclick = function (event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }
        // Initialize and add the map
        /*function initMap() {
          // The location of Uluru
          var uluru = {lat: 38.971500, lng: -76.940308};
                  // The map, centered at Uluru
                  var map = new google.maps.Map(
              document.getElementById('map'), {zoom: 6, center: uluru});
              // The marker, positioned at Uluru
          var marker = new google.maps.Marker({position: uluru, map: map});
                }
                */
        /* Leaflet Code */
        /* Not using post for now */
        function loadLeaflet() {
          fetch('/leaflet')
            .then(res => res.json())
            .then(data => {
              /* Map all needed variables, keep district for indexing/filtering */
              let district = data.map(c => c.district);
              let address = data.map(c => c.street_address);
              let latitude = data.map(c => c.location_1.latitude);
              let longitude = data.map(c => c.location_1.longitude);
              let arr = [];
              let ele = [];
              let drop = document.getElementById("dropdown");
              let currOption = drop.options[drop.selectedIndex].textContent;
              /* Iterate through to create desired arrays*/
              for (let i = 0; i < district.length; i++) {
                if (district[i] === currOption) {
                  ele = [address[i], latitude[i], longitude[i]]
                  arr[i] = ele;
                }
              }
              /* Make readable */
              arr = arr.join('\n');
              for (var i = 0; i < arr.length; i++) {
                var lon = arr[i][2];
                var lat = arr[i][1];
                var popupText = arr[i][0];
                var markerLocation = new L.LatLng(lat, lon);
                var marker = new L.Marker(markerLocation);
                map.addLayer(marker);
                marker.bindPopup(popupText);
              }
              /* Double check (comment out when done) */
              console.log(arr);
              return arr;
            }
            )
        }
      </script>
      <script>
        var map = L.map('map', {
          center: [38.989697, -76.937759],
          zoom: 10
        });
        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        var icon = L.divIcon({
          className: 'custom-div-icon',
          html: "<div style='background-color:#4838cc;' class='marker-pin'></div><i class='fa fa-camera awesome'>",
          iconSize: [30, 42],
          iconAnchor: [15, 42]
        });
        var markers = [
          [38.952593, -76.942069, "Posted Speed: 25, Enforced Speed: 37"],
          [39.003744, -76.967017, "Posted Speed: 30, Enforced Speed: 42"],
          [39.104911, -76.866641, "Posted Speed: 40, Enforced Speed: 52"],
          [38.80328, -76.99046, "Posted Speed: 30, Enforced Speed: 42"],
          [39.035252, -76.918569, "Posted Speed: 25, Enforced Speed: 37"],
          [38.818501, -76.75007, "Posted Speed: 30, Enforced Speed: 42"],
          [38.960971, -76.740467, "Posted Speed: 30, Enforced Speed: 42"],
          [38.704471, -76.882348, "Posted Speed: 30, Enforced Speed: 42"],
          [38.879544, -76.826481, "Posted Speed: 35, Enforced Speed: 47"],
        ];
        for (var i = 0; i < markers.length; i++) {
          marker = new L.marker([markers[i][0], markers[i][1]], { icon: icon })
            .bindPopup(markers[i][2])
            .addTo(map);
        }
      </script>
</body>

</html>